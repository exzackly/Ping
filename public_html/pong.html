<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>pong.html</title>
    <script type="text/javascript"
            src = "simpleGame.js"></script>
    <script type="text/javascript">
    var scene;
    var ball;
    var paddlePlayer;
    var paddleComp;
    var joy = new Joy();
    
    function Ball(){
        //class definition for ball
        tBall = new Sprite(scene, "redBall.png", 20, 20);
        
        tBall.checkBounce = function(paddle){
            //responds to a collision with the given paddle
            //Max and min dy 
            MAX = 10
            if (this.collidesWith(paddle)){
                this.setDX(this.dx * -1);            
            
                dy = this.y - paddle.y;
                dy = ((dy / paddle.height) * 2);
                //console.log("dy: " + dy);
                dy *= MAX;
                this.setDY(dy);
            } // end if
        } // end checkBounce

        tBall.checkBounds = function(){
            //overwrite checkbounds function to give
            //custom behavior
            
            //bounce off of top and bottom
            if (this.y < 0){
                this.setDY(this.dy * -1);
            }
            if (this.y > scene.height){
                this.setDY(this.dy * -1);
            }
            
            //wrap off of sides
            if(this.x < 0){
                this.setPosition(scene.width - 150, this.y);
                //computer scores
            } // end if
            if (this.x > scene.width){
                this.setPosition(150, this.y);
                //player scores
            } // end if
        } // end checkBounds
        
        return tBall;
    } // end Ball def
    
    function Paddle(){
        //class definition for paddle
        V_SPEED = 10;
        BRAINS = .7 //percentage likelihood paddle will move each turn
        tPaddle = new Sprite(scene, "paddleV.png", 10, 50);
        
        tPaddle.followMouse = function(){
            //follows mouse for player control
            this.setImgAngle(90);
            this.setPosition(this.x, scene.getMouseY());
        } // end followMouse method
        
        tPaddle.autoMove = function(){
            //automatically moves
            this.setImgAngle(90);
            
            //don't move on every turn
            if (Math.random() < BRAINS){
                if (this.y > ball.y){
                  this.setMoveAngle(0);
                } else {
                    this.setMoveAngle(180);
                } // end if

                this.setSpeed(V_SPEED);
            } // end if
        } // end autoMove
        
        return tPaddle;
    }
    
    function init(){
        scene = new Scene();
        scene.setBG("black");
        scene.hideCursor();
        ball = new Ball();
    
        paddlePlayer = new Paddle();
        paddlePlayer.setPosition(100, 100);
        paddlePlayer.setMoveAngle(0);
        
        paddleComp = new Paddle();
        paddleComp.setPosition(700, 100);
        paddleComp.setMoveAngle(180);
    
        scene.start();
    } // end init
    
    function update(){
        scene.clear();
        //ball.checkScore();

        paddlePlayer.followMouse();
        paddleComp.autoMove();

        ball.checkBounce(paddlePlayer);
        ball.checkBounce(paddleComp);
        //updateScore();        
        ball.update();


        paddlePlayer.update();
        paddleComp.update();
    
    } // end update
    
    </script>
</head>
<body onload = "init()">
</body>
</html>